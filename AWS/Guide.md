AWS EC2: 가상 서버(컴퓨터) 만들기
**왜 필요한가요?**
클라우드 상에 나만의 컴퓨터(Linux 서버)를 한 대 임대하는 것입니다.

### 1. EC2 대시보드 및 리전 설정
1.  콘솔 우측 상단의 지역 이름(예: 버지니아 북부)을 클릭하여 **[아시아 태평양(서울) ap-northeast-2]**를 선택합니다.
2.  상단 검색창에 `EC2` 입력 후 접속합니다.
3.  중앙의 주황색 버튼 **[인스턴스 시작]**을 클릭합니다.

### -2. 인스턴스 설정 (상세)
1.  **이름 및 태그**:
    *   **이름**: `MyFirstWebServer` 입력.
2.  **애플리케이션 및 OS 이미지(AMI)**:
    *   `Amazon Linux` 선택 (기본값).
    *   **AMI**: `Amazon Linux 2023 AMI` 확인 (프리 티어 사용 가능 태그 확인).
3.  **인스턴스 유형**:
    *   `t2.micro` 또는 `t3.micro` 선택 (프리 티어 사용 가능 태그 확인).
4.  **키 페어(로그인)** (가장 중요!):
    *   우측의 **[새 키 페어 생성]** 텍스트 링크 클릭.
    *   **키 페어 이름**: `my-ec2-key` 입력.
    *   **키 페어 유형**: `RSA` 선택.
    *   **프라이빗 키 파일 형식**: `.pem` 선택.
    *   **[키 페어 생성]** 버튼 클릭.
    *   **확인**: 브라우저가 자동으로 `my-ec2-key.pem` 파일을 다운로드합니다. 내 PC의 `다운로드(Downloads)` 폴더를 확인하세요. 이 파일은 서버의 열쇠이므로 절대 잃어버리면 안 됩니다.
5.  **네트워크 설정**:
    *   우측 상단 **[편집]** 버튼 클릭.
    *   **보안 그룹 이름**: `web-server-sg` 등으로 변경.
    *   **인바운드 보안 그룹 규칙**:
        *   유형: `ssh`
        *   소스 유형: `위치 무관(0.0.0.0/0)` -> 보안을 위해 **[내 IP]**로 변경 권장.
6.  **스토리지 구성**: 기본값(8 GiB, gp3) 유지.
7.  우측 요약 패널 하단의 **[인스턴스 시작]** 클릭.

---

## 2. 내 PC(Windows)에서 EC2 접속하기
**목표**: 방금 다운로드한 키 파일을 이용해 내 컴퓨터의 검은 화면(터미널)에서 AWS 서버로 접속합니다.

### 2-1. 키 파일 준비
1.  파일 탐색기(`Win+E`)를 엽니다.
2.  `내 PC` -> `로컬 디스크 (C:)`로 이동하여 `AWS`라는 새 폴더를 만듭니다 (`C:\AWS`).
3.  `다운로드` 폴더에 있는 `my-ec2-key.pem` 파일을 복사하여 `C:\AWS` 폴더 안에 붙여넣습니다. (최종 경로: `C:\AWS\my-ec2-key.pem`)

### 2-2. 터미널(PowerShell) 실행
1.  키보드의 `Windows` 키를 누르고 `PowerShell`을 입력합니다.
2.  나오는 아이콘에 마우스 우클릭 -> **[관리자 권한으로 실행]** 클릭.

### 2-3. 키 파일 권한 설정 (필수)
AWS는 키 파일이 너무 공개되어 있으면 접속을 차단합니다. 아래 명령어를 복사해서 PowerShell에 붙여넣고 엔터(Enter)를 치세요.

```powershell
# 1. 상속된 권한 제거
icacls.exe "C:\AWS\my-ec2-key.pem" /reset

# 2. 현재 사용자에게만 읽기 권한 부여 (나 외에 아무도 못 쓰게 설정)
icacls.exe "C:\AWS\my-ec2-key.pem" /grant:r "$($env:USERNAME):(R)" /inheritance:r
```
*성공 시 `처리된 파일: C:\AWS\my-ec2-key.pem 1개` 같은 메시지가 뜹니다.*

### 2-4. 접속 명령어 입력
1.  AWS 콘솔로 돌아와 실행 중인 `MyFirstWebServer` 인스턴스를 클릭합니다.
2.  화면 중앙 아래쪽 상세 정보 탭에서 **[퍼블릭 IPv4 주소]** (예: 3.12.34.56)를 찾아 복사 아이콘을 누릅니다.
3.  PowerShell에 아래 명령어를 입력합니다. (`<IP주소>` 부분은 지우고 복사한 IP를 붙여넣으세요)

```powershell
ssh -i "C:\AWS\my-ec2-key.pem" ec2-user@<여기에-복사한-IP주소-붙여넣기>
```

4.  엔터를 치면 `Are you sure... (yes/no)?` 라고 묻습니다. `yes` 라고 타이핑하고 엔터를 칩니다.
5.  화면에 `[ec2-user@ip-172-31-...]` 같은 글자가 뜨면 접속 성공입니다!

---


## 3단계: 데이터베이스 (RDS) 구축 및 연결
가장 많은 오류가 발생하는 구간입니다. **'직접 접속(Public)'** 방식과 **'SSH 터널링(Private)'** 방식 중 하나를 선택하세요.

### 3-1. RDS 데이터베이스 생성 (MySQL)
1.  **RDS** 서비스 접속 -> **[데이터베이스 생성]**.
2.  **생성 방식**: `표준 생성`.
3.  **엔진 옵션**: `MySQL` (Community).
4.  **템플릿**: **[프리 티어]** (과금 방지를 위해 필수).
5.  **설정**:
    *   **DB 인스턴스 식별자**: `mydb`
    *   **마스터 사용자 이름**: `admin`
    *   **마스터 암호**: `mypassword1234` (복잡하게 설정 후 메모).
6.  **인스턴스 구성**: `db.t3.micro` 또는 `db.t4g.micro` (프리 티어).
7.  **연결 (핵심 설정 )**: ← **이 단계가 외부 접속 성공의 90%를 결정합니다!**
    
    **[7-1] 기본 설정**
    *   **컴퓨팅 리소스**: `EC2 컴퓨팅 리소스에 연결 안 함` 선택. (수동 연결이 학습에 유리)
    *   **VPC**: 기본 VPC 선택 (vpc-xxxx).
    
    **[7-2] 서브넷 그룹 설정**
    기본 설정 없음 (No preference)"으로 설정했을 때의 결과:

   1. 자동 할당: AWS가 현재 리전(서울)의 데이터 센터(가용 영역 a, b, c, d 등) 중 하나를 자동으로 선택하여 데이터베이스를 생성합니다.
   설정 없음"으로 두는 것이 
      가장 무난하고 권장되는 방식입니다.

    
    **`default` 서브넷 그룹이 보이는 경우** (매우 드뭄):
    *   즉시 `default` 선택 → 라우팅 설정 불필요
    
    **[7-3] 퍼블릭 액세스 (필수 )**
    *   **퍼블릭 액세스 가능**: `예` 선택. ← 반드시!
        *   `아니요` 선택 시 → SSH 터널링으로만 접속 가능
    
    **[7-4] 보안 그룹 (가장 중요! )**
    *   **VPC 보안 그룹(방화벽)**: 
        *   **"새로 생성"** 라디오 버튼 선택
        *   입력란에 **`rds-public-2026`** 입력 ← 필수 입력!
        *    **비워두면 생성 실패하거나 접속 불가**합니다!
    
    **[7-5] 기타 설정**
    *   **가용 영역**: `기본 설정 없음` (그대로)
    *   **RDS 프록시**: 체크 **해제** (비용 발생 방지)

8.  **추가 구성** (하단 펼치기):
    *   **초기 데이터베이스 이름**: `demo_db` 입력 (비워두면 DB 스키마 없이 생성됨).
    *   **백업**: 학습용이라면 "자동 백업 활성화" 체크 해제 가능.

9.  **[데이터베이스 생성]** 클릭 (5~10분 소요).

---

** 생성 후 필수 확인 사항 **

10. **생성 완료 대기** (상태: `생성 중` → `사용 가능`)

11. **서브넷 확인**:
기본 설정 없음 (No preference)"으로 설정했을 때의 결과:

   1. 자동 할당: AWS가 현재 리전(서울)의 데이터 센터(가용 영역 a, b, c, d 등) 중 하나를 자동으로 선택하여 데이터베이스를 생성합니다.
   2. 동작에 차이 없음: 특정 가용 영역(예: ap-northeast-2a)을 강제로 지정하지 않아도, RDS의 기능이나 성능, 접속 방법에는 아무런 차이가 없습니다.
   3. 권장 사항: 특별히 EC2와 같은 가용 영역에 두어야 하는 고급 구성이 아니라면, AWS가 자원 여유가 있는 곳에 알아서 만들어주도록 "기본 설정 없음"으로 두는 것이 
      가장 무난하고 권장되는 방식입니다.
    

### 3-2. 외부 접속 설정 완료 및 트러블슈팅 

RDS 생성이 완료되면 아래 순서대로 설정하고 테스트합니다.

---

##  필수 설정 체크리스트 (순서대로 진행)

###  1단계: 보안 그룹 규칙 추가 (필수)

RDS 생성 시 만든 보안 그룹은 **기본적으로 모든 접속을 차단**합니다. 반드시 규칙을 추가해야 합니다.

1.  **AWS 콘솔** → **EC2** 서비스 접속
2.  **왼쪽 메뉴**: **"네트워크 및 보안"** → **"보안 그룹"** 클릭
3.  **보안 그룹 검색**: 
    *   검색창에 `rds-public-2026` 입력 (또는 생성 시 입력한 이름)
4.  해당 보안 그룹 선택 → 하단 **[인바운드 규칙]** 탭 → **[인바운드 규칙 편집]** 클릭
5.  **[규칙 추가]** 버튼을 눌러 다음 규칙을 추가:

    **규칙 1: 내 PC에서 접속 허용**
    *   유형: `MYSQL/Aurora` (포트 3306 자동 입력)
    *   소스: **`내 IP`** (드롭다운에서 선택하면 현재 IP 자동 입력)
    *   설명: `My PC access`
    
    **규칙 2 (선택): EC2 서버에서 접속 허용** (EC2에서 RDS 접속 필요 시)
    *   유형: `MYSQL/Aurora`
    *   소스: **`사용자 지정`** → 검색창에 `web-sg` (EC2 보안 그룹 이름) 입력 후 선택
    *   설명: `EC2 access`
    *    **주의**: 소스에 자기 자신(`rds-public-2026`) 넣으면 안 됩니다!

6.  **[규칙 저장]** 클릭
